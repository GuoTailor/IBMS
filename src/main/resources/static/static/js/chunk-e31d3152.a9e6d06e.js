(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e31d3152"],{"40a4":function(t,e,a){"use strict";a.d(e,"b",(function(){return n})),a.d(e,"a",(function(){return o})),a.d(e,"c",(function(){return r})),a.d(e,"d",(function(){return l}));var i=a("b775");function n(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30;return Object(i["a"])({url:"/user/all",method:"get",params:{page:t,size:e}})}function o(t){return Object(i["a"])({url:"/user",method:"delete",data:{id:t}})}function r(t,e,a,n){return Object(i["a"])({url:"/common/register",method:"post",data:{name:t,username:e,telephone:a,password:n}})}function l(t,e,a,n,o){return Object(i["a"])({url:"/user",method:"PUT",customParam:{requestDataType:"json"},data:{id:t,name:e,username:a,telephone:n,password:o}})}},"67f0":function(t,e,a){"use strict";a("9e6c")},"9e6c":function(t,e,a){},aedb:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("el-row",{staticClass:"search-box",attrs:{type:"flex",justify:"space-between"}},[a("el-col",{attrs:{span:12}},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入内容"},on:{change:t.handleSearch},model:{value:t.selectValue,callback:function(e){t.selectValue=e},expression:"selectValue"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.handleSearch},slot:"append"})],1)],1),a("el-button",{attrs:{type:"primary"},on:{click:t.handleCreate}},[t._v("添加单位")])],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],attrs:{data:t.list,"element-loading-text":"Loading",border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{align:"center",label:"序号",width:"95"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v(" "+t._s(a.id)+" ")]}}])}),a("el-table-column",{attrs:{label:"单位名称"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v(" "+t._s(a.name)+" ")]}}])}),a("el-table-column",{attrs:{label:"单位地址",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("span",[t._v(t._s(i.site))])]}}])}),a("el-table-column",{attrs:{label:"单位负责人",width:"110",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v(" "+t._s(a.user.name)+" ")]}}])}),a("el-table-column",{attrs:{"class-name":"status-col",label:"负责人电话",width:"110",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v(" "+t._s(a.user.telephone)+" ")]}}])}),a("el-table-column",{attrs:{align:"center",prop:"created_at",label:"创建时间",width:"250"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("i",{staticClass:"el-icon-time"}),a("span",[t._v(t._s(t._f("parseTime")(i.createTime)))])]}}])}),a("el-table-column",{attrs:{label:"操作",width:"140",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row,n=e.$index;return[a("el-row",[a("el-col",{attrs:{span:12}},[a("abbr",{attrs:{title:"编辑"}},[a("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-edit"},on:{click:function(e){return t.handleUpdate(i)}}})],1)]),a("el-col",{attrs:{span:12}},[a("el-popconfirm",{attrs:{"confirm-button-text":"删除","cancel-button-text":"取消","confirm-button-type":"danger",icon:"el-icon-delete","icon-color":"red",title:"确定删除该条数据吗？"},on:{onConfirm:function(e){return t.handleDelete(i,n)}}},[a("abbr",{attrs:{slot:"reference",title:"删除"},slot:"reference"},[a("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete"}})],1)])],1)],1)]}}])})],1),a("el-pagination",{staticClass:"pagination-box",attrs:{background:"",layout:"prev, pager, next","page-size":t.pageSize,"page-count":t.page,total:t.totalCount},on:{"current-change":t.fetchData}}),a("el-dialog",{attrs:{title:t.textMap[t.dialogStatus],visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-form",{ref:"dataForm",staticStyle:{width:"400px","margin-left":"30px"},attrs:{rules:t.rules,model:t.temp,"label-position":"left","label-width":"100px"}},[a("el-form-item",{attrs:{label:"单位名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入单位名称"},model:{value:t.temp.name,callback:function(e){t.$set(t.temp,"name",e)},expression:"temp.name"}})],1),a("el-form-item",{attrs:{label:"单位地址",prop:"site"}},[a("el-input",{attrs:{placeholder:"请输入单位地址"},model:{value:t.temp.site,callback:function(e){t.$set(t.temp,"site",e)},expression:"temp.site"}})],1),a("el-form-item",{attrs:{label:"单位负责人",prop:"unitLeader"}},[a("el-select",{staticClass:"filter-item",attrs:{placeholder:"请选择单位负责人"},model:{value:t.temp.unitLeader,callback:function(e){t.$set(t.temp,"unitLeader",e)},expression:"temp.unitLeader"}},t._l(t.unitLeaderOptions,(function(t){return a("el-option",{key:t.id,attrs:{label:t.username,value:t.id}})})),1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v(" 取消 ")]),a("el-button",{attrs:{type:"primary",loading:t.dialogFormSobmitLoading},on:{click:function(e){"create"===t.dialogStatus?t.createData():t.updateData()}}},[t._v(" 保存 ")])],1)],1)],1)},n=[],o=(a("4160"),a("a434"),a("b0c0"),a("159b"),a("40a4")),r=a("b775");function l(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30;return Object(r["a"])({url:"/unit/all",method:"get",params:{page:t,size:e}})}function s(t){return Object(r["a"])({url:"/unit",method:"delete",data:{id:t}})}function c(t,e,a){return Object(r["a"])({url:"/unit",method:"post",customParam:{requestDataType:"json"},data:{site:t,userId:e,name:a}})}function u(t,e,a,i){return Object(r["a"])({url:"/unit",method:"PUT",customParam:{requestDataType:"json"},data:{id:t,site:e,userId:a,name:i}})}var d=a("ed08"),m={filters:{parseTime:d["b"]},data:function(){return{list:null,page:1,pageSize:30,totalCount:0,listLoading:!0,dialogFormVisible:!1,dialogFormSobmitLoading:!1,selectValue:"",textMap:{update:"修改单位",create:"添加单位"},temp:{id:void 0,name:"",site:"",unitLeader:""},dialogStatus:"",unitLeaderOptions:[],rules:{name:[{required:!0,message:"单位名称不能为空",trigger:"blur"}],site:[{required:!0,message:"单位地址不能为空",trigger:"blur"}],unitLeader:[{required:!0,message:"单位负责人不能为空",trigger:"blur"}]}}},created:function(){this.fetchData()},methods:{fetchData:function(t){var e=this;t&&(this.page=t),this.listLoading=!0,l(this.page,this.pageSize).then((function(t){var a=t.code,i=t.data,n=t.msg;if(0===a){var o=i.total,r=i.list;e.list=r,e.totalCount=o}else e.$notify.error(n);e.listLoading=!1})).catch((function(t){e.$notify.error("单位信息列表获取失败")}))},getAllUserList:function(){this.isLoadUserList||(this.isLoadUserList=!0,this.singleUserList(1,30))},singleUserList:function(t,e){var a=this;Object(o["b"])(t,e).then((function(t){var i=t.code,n=t.data;if(0===i){var o=n.list,r=n.pages,l=n.pageNum;o.forEach((function(t){a.unitLeaderOptions.push({id:t.id,username:t.name})})),l<r&&a.singleUserList(l+1,e)}}))},handleUpdate:function(t){var e=this;this.getAllUserList(),this.temp=Object.assign({unitLeader:t.userId},t),this.dialogStatus="update",this.dialogFormVisible=!0,this.$nextTick((function(){e.$refs["dataForm"].clearValidate()}))},handleCreate:function(){var t=this;this.getAllUserList(),this.temp={},this.dialogStatus="create",this.dialogFormVisible=!0,this.$nextTick((function(){t.$refs["dataForm"].clearValidate()}))},handleSearch:function(){console.log(this.selectValue)},handleDelete:function(t,e){var a=this,i=t.id,n=t.name;s(i).then((function(t){var i=t.code;t.data,t.msg;0===i&&(a.$notify({title:"删除成功！",message:"单位 ” ".concat(n," “ 已删除"),type:"success",duration:3e3}),a.list.splice(e,1))}))},updateData:function(){var t=this;this.$refs["dataForm"].validate((function(e){if(e){t.dialogFormSobmitLoading=!0;var a=t.temp,i=a.id,n=a.name,o=a.site,r=a.unitLeader;u(i,o,r,n).then((function(e){t.dialogFormSobmitLoading=!1;var a=e.code,i=e.msg;e.data;0===a?(t.$notify({title:"更新单位",message:"成功更新单位：".concat(n),type:"success",duration:3e3}),t.fetchData(),t.dialogFormVisible=!1):t.$notify.info(i)})).catch((function(e){t.dialogFormSobmitLoading=!1,t.$notify.error("更新单位错误！")}))}}))},createData:function(){var t=this;this.$refs["dataForm"].validate((function(e){if(e){t.dialogFormSobmitLoading=!0;var a=t.temp,i=a.name,n=a.site,o=a.unitLeader;c(n,o,i).then((function(e){t.dialogFormSobmitLoading=!1;var a=e.code,n=e.msg;e.data;0===a?(t.$notify({title:"添加单位",message:"成功添加单位：".concat(i),type:"success",duration:3e3}),t.fetchData(),t.dialogFormVisible=!1):t.$notify.info(n)})).catch((function(e){t.dialogFormSobmitLoading=!1,t.$notify.error("创建单位错误！")}))}}))}}},p=m,f=(a("67f0"),a("2877")),g=Object(f["a"])(p,i,n,!1,null,"7503aa0a",null);e["default"]=g.exports}}]);